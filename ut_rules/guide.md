# 使用 Cursor 和 Roo Code 插件快速生成单元测试指南

本指南介绍如何使用 Cursor（版本 > 0.49.6）和 Roo Code 插件，根据现有代码快速生成单元测试。以下是详细步骤和注意事项。

## 1. 安装 Cursor 和 Roo Code 插件

**步骤：**

* **下载并安装 Cursor：**
    * 访问 [Cursor 官网](https://www.cursor.com/cn)，下载最新版本。
    * 安装完成后，启动 Cursor，确保其正常运行。
* **安装 Roo Code 插件：**
    * 在 Cursor 中，打开扩展面板（快捷键：`Ctrl+Shift+X` 或 `Cmd+Shift+X`）。
    * 搜索“Roo Code”，点击安装。
    * 安装完成后，在活动栏中会看到 Roo Code 图标，表示插件已启用。

## 2. 配置 Roo Code 插件

**步骤：**

* **打开 Roo Code 设置：**
    * 点击活动栏中的 Roo Code 图标，打开插件面板。
    * 在插件页面右上角，点击设置图标（齿轮）进入设置页面。
    
* **配置大模型参数：**
  
    * 在【提供商】页面，添要使用的大模型 API（如 DeepSeek-V3）。
    * 输入 API 密钥。
    
* **启用自动批准：**
    * 在【自动批准】页面，勾选【自动批准】选项。
    
    * 授予插件读取、写入文件及执行终端命令的所有权限，以确保生成和修改代码时无需手动确认。
    
      **注意：** 自动批准可能带来安全风险，请酌情使用。
    
* **配置完成后，点击【保存】按钮。**

## 3. 设置 Roo Code 的工作模式

**步骤：**

* **打开 Roo Code 面板：**
    * 点击活动栏中的 Roo Code 图标，进入插件的交互界面。
* **切换到 Orchestrator 模式：**
    * 在 Roo Code 输入框上方的模式选择器中，选择“Orchestrator”模式。
    * Orchestrator 模式适合协调多文件操作和复杂任务，如生成单元测试并管理项目上下文。

## 4. 生成单元测试

**步骤：**

* **指定源码目录：**
    * 在 Roo Code 输入框中，使用 `@` 符号指定需要生成单元测试的源目录。
* **输入提示词：**
    * 输入清晰的提示词，描述生成单元测试的需求。具体请参考：[rules.md](rules.md)
    * [rules.md](rules.md) 同样适用于 Curosr 的 rule 规则，不过 Cursor 连续生成效果相较于Roo Code 要差一些。
* **执行生成：**
    * 提交提示词后，Roo Code 将调用配置的大模型生成测试代码，并自动写入指定目录。
    * 生成的测试文件会出现在指定目录（通常为 tests/）。

## 5. 使用 Cursor 的 Agent 模式修复编译问题

单元测试生成完毕后，可以使用 Roo Code 或者 Cursor 自带的 Agent 模式解决编译问题。根据实践比较，这里推荐使用 Cursor 的 Agent 模式。

**步骤：**

* **切换到 Agent 模式：**
  
    * 在 Cursor 的主界面中，点击顶部工具栏中的“Agent”模式按钮，进入 AI 驱动的任务处理模式。
    
* **指定测试目录：**
    * 使用 `@` 符号指定测试目录（如 `@tests`），或直接选中包含测试代码的文件。
    
* **输入修复提示词：**
    * 输入提示词以自动编译并修复测试代码中的问题。例如：
        ```
        当前目录下文件为大模型生成，需要自动编译并完成问题修复。
        ```
    * Cursor 的 Agent 模式会分析代码、运行测试，并尝试修复编译错误或测试失败的问题。
